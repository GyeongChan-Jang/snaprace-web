# 루트 도메인 랜딩 & 서브도메인 이벤트 경험

## 요약
- 현재 `snap-race.com`은 조직 서브도메인용으로 설계된 이벤트 검색 UI를 그대로 노출하고 있습니다.
- 목표는 루트 도메인을 회사 소개 및 전환 중심의 랜딩 페이지로 전환하고, `*.snap-race.com` 서브도메인은 지금처럼 조직별 이벤트 탐색에 집중하도록 유지하는 것입니다.
- 미들웨어에서 이미 서브도메인을 감지해 `x-organization` 헤더를 주입하므로, UI 레이어에서 도메인에 따라 분기만 하면 됩니다.

## 현행 아키텍처 및 동작
- `src/middleware.ts`가 호스트명을 파싱해 서브도메인을 식별하고, 해당 값을 `x-organization` 헤더로 넘깁니다. 서브도메인이 없으면 사실상 메인 사이트 트래픽(`!subdomain`)으로 취급합니다.
- `src/app/layout.tsx`와 `src/app/organization-loader.tsx`는 도메인 타입과 관계없이 조직 데이터를 조회해 Provider로 감쌉니다.
- `src/app/page.tsx`는 클라이언트 컴포넌트이며, 항상 비브 검색 히어로와 이벤트 선택 UI를 렌더링합니다. `OrganizationHelper`를 통해 문구만 조직별로 치환합니다.
- `Header`와 `Footer`는 조직 브랜딩 정보를 읽어 오지만, 조직이 없을 때도 이벤트 검색 중심 네비게이션을 유지합니다.
- tRPC 컨텍스트(`createTRPCContext`)는 `ctx.isMainSite`를 제공하고 있으며, `events.getAll`은 이를 활용해 조직 필터링 여부를 결정합니다.

## 발견된 갭과 영향
- 루트 도메인에는 제품 소개, 가격/문의 CTA, SEO용 컨텐츠가 없어 신규 방문자에게 제품 맥락을 전달하지 못합니다.
- 네비게이션이 항상 "Search", "Events"에 맞춰져 있어 랜딩 페이지로서는 부적합한 동선을 제공합니다.
- 홈 라우트가 클라이언트 컴포넌트라서 마케팅/이벤트 흐름별로 서버 사이드 메타데이터나 컨텐츠를 깔끔하게 분리하기 어렵습니다.

## 권장 방향
1. **홈 라우트 서버 분기**
   - `src/app/page.tsx`를 서버 컴포넌트로 전환해 `headers().get("x-organization")` 값을 읽습니다.
   - `subdomain`이 없으면 새 마케팅 트리를, 있으면 기존 이벤트 검색 경험(예: `EventSearchHome`)을 렌더링합니다.
   - 루트 도메인 요청에서는 `src/app/organization-loader.tsx`가 조직 조회를 건너뛰도록 early return을 추가해 불필요한 데이터 패치를 줄입니다.
   - 두 트리를 `src/app/_components` 아래에 모아 라우트 간 의존성을 줄입니다.
2. **마케팅 랜딩 구성**
   - 고전적 SaaS 랜딩 구조에 맞춰 네비게이션, 히어로, 파트너 로고, 효익 소개, 사용 방법(3단계), 가격 정책, 후기, FAQ, CTA 섹션, 푸터 순으로 콘텐츠를 배치합니다.
   - 각 섹션은 제품·회사 소개에 집중하며 이벤트 하이라이트는 제외합니다.
   - 텍스트는 `src/content/landing.ts` 같은 설정 파일에 구조화해 카피 교체를 코드 수정 없이 처리합니다.
   - 기본적으로 서버 컴포넌트로 작성하고, 캐러셀 등 인터랙션이 필요한 구간만 클라이언트로 분기합니다.
3. **도메인 인식 헤더/푸터**
   - `OrganizationContext`에 `isDefaultSite`(또는 동등한 불 변형 속성)를 추가해 Header/Footer가 간결하게 분기하도록 합니다.
   - `Header`에서는 루트 도메인일 때 최소 메뉴와 고강도 CTA 중심의 레이아웃을 유지하고, 서브도메인에서는 기존 이벤트 탐색용 네비를 제공합니다.
   - `Footer`도 루트 도메인일 때 회사 소개·지원 링크를 노출하고, 서브도메인일 때만 파트너 섹션을 유지합니다.
4. **메타데이터 및 에셋**
   - 새 서버 컴포넌트에서 `generateMetadata`를 활용하거나 전용 헬퍼를 만들어 마케팅용 OG/Twitter 메타를 세팅합니다.
   - 랜딩에 사용할 이미지는 `public/images/marketing/` 경로에 정리합니다.
5. **라우팅 및 리다이렉트**
   - `www.snap-race.com`을 루트 도메인과 동일하게 처리할지, apex로 리다이렉트할지 확인 후 미들웨어를 조정합니다.
   - `/events`, `/photo`, `/privacy-policy` 등 공용 라우트는 두 도메인 모두에서 접근 가능하게 유지합니다.

## 구현 시 고려사항
- 현재 홈 UI를 `src/app/_components/EventSearchHome.tsx` 등으로 분리해 서버 엔트리를 가볍게 유지합니다.
- `OrganizationHelper` 또는 `OrganizationContext`에 `isDefaultSite` 같은 계산 속성을 추가해 공통 컴포넌트에서 조건 분기 시 활용할 수 있습니다.
- 루트 도메인 경로에서는 서버 렌더링만으로 충분히 처리가 가능하므로, tRPC 호출을 최소화해 초기 로드를 빠르게 유지합니다.
- 공유 컴포넌트(헤더/푸터 등)에서는 단순한 `if (subdomain)` 분기로 기능을 나누어 조직 포털 동작을 해치지 않습니다.
- 모바일-first 반응형을 가장 먼저 고려하고, 데스크톱 레이아웃은 확장 형태로 정의합니다.

## 엣지 케이스 및 QA 노트
- 로컬 개발 시 `?org=...` 또는 `NEXT_PUBLIC_DEV_SUBDOMAIN`을 사용해 서브도메인 동작을 검증합니다.
- `pnpm check`와 수동 스모크 테스트로 루트/서브도메인 홈, `/events`, `/events/[event]/[bib]` 흐름을 모두 확인합니다.

## 마케팅 UX 설계 원칙
- 모바일 퍼스트·반응형: 스마트폰에서 먼저 최적화하고, 모든 요소가 모바일에서 쉽게 읽히고 작동하도록 설계합니다.
- 미니멀 내비/콘텐츠 집중: CTA, 헤드라인, 핵심 가치 전달에 집중하도록 여백과 메뉴를 최소화합니다.
- 강력한 헤드라인: 한 문장 안에서 서비스의 핵심 가치와 강점을 명료하게 전달합니다.
- 비주얼/인터랙션 적극 활용: 제품 영상, 3D/스크린샷, 인터랙티브 데모 등으로 직접 체험을 유도합니다.
- 소셜 프루프 강조: 후기, 사용 사례, 인증/보안 표식, 파트너 로고 등 신뢰 신호를 반복적으로 노출합니다.
- 단계별 경험 안내: 기능 나열이 아닌 고객 여정 기반의 베네핏·사용법을 단계별로 설명합니다.
- 투명한 가격/구독: 무료 체험, 유료 플랜을 명확히 구분해 구매 경로를 투명하게 제공합니다.
- 반복적 CTA 노출: 가입/문의 CTA를 여러 섹션에서 지속 노출해 전환을 유도합니다.
- FAQ/지원 연결 강화: 챗봇, 빠른 문의 채널, 실시간 FAQ 등으로 즉각적인 도움을 제공합니다.
- SEO·퍼포먼스 최적화: 2초 이내 로딩, 구조화된 헤딩과 스키마, 메타태그 최적화를 목표로 합니다.

## 확정된 요구사항 정리
- 랜딩 페이지는 네비게이션 바, 히어로, 파트너 로고, 주요 효익, 사용 방법, 가격 정책, 고객 후기, FAQ, CTA, 푸터 구성으로 작성합니다.
- 루트 도메인은 제품·회사 소개에 집중하며 이벤트 하이라이트 섹션은 포함하지 않습니다.
- 공용 컨텍스트에 `isDefaultSite` 신호를 추가해 헤더/푸터 등에서 분기를 단순화합니다.
- 루트 도메인 요청에서는 조직 데이터를 조회하지 않고 early return으로 빠집니다.
- 모바일 퍼스트 UX, 미니멀 내비, 강력한 헤드라인, 비주얼/인터랙션 강화, 소셜 프루프, 단계별 베네핏, 투명한 가격, 반복 CTA, FAQ/지원 연결, SEO/퍼포먼스 최적화 원칙을 준수합니다.
- 구현되는 컴포넌트와 코드 네이밍은 영어를 사용합니다.
