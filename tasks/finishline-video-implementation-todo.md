# 피니시라인 비디오 구현 TODO 목록

## 1단계: 컴포넌트 생성

### 1.1 FinishlineVideo 컴포넌트 구조 생성
- [ ] `src/app/events/[event]/[bib]/_components/FinishlineVideo.tsx` 파일 생성
- [ ] 컴포넌트 props를 위한 TypeScript 인터페이스 정의
- [ ] React imports를 포함한 기본 컴포넌트 구조 설정
- [ ] 필요한 의존성 imports (react-player, UI 컴포넌트)

### 1.2 컴포넌트 Props 인터페이스
```typescript
interface FinishlineVideoProps {
  event: Event; // finishline_video_info를 포함한 이벤트
  timingDetail: BibDetailResponse | null; // 참가자 타이밍 데이터
  isAllPhotos: boolean; // 모든 사진 또는 특정 bib 표시 여부
}
```

### 1.3 비디오 시작 시간 계산 로직
- [ ] 시작 시간 계산 함수 구현
- [ ] timingDetail이 null인 경우 처리 (isAllPhotos = true)
- [ ] firstParticipantGunTime을 사용할 수 없는 경우 처리
- [ ] 적절한 타입 검사 및 오류 처리 추가
- [ ] 공식: `startTime = firstParticipantVideoTime + (participantGunTime - firstParticipantGunTime)`

## 2단계: 비디오 구현

### 2.1 React Player 통합
- [ ] react-player import 및 설정
- [ ] YouTube 비디오 URL 처리 설정
- [ ] 적절한 설정으로 비디오 플레이어 구성
- [ ] 반응형 비디오 차원 구현

### 2.2 비디오 컨트롤 및 설정
- [ ] 계산된 값으로 비디오 시작 시간 설정
- [ ] 플레이어 컨트롤 설정 (재생, 일시정지, 볼륨)
- [ ] 비디오 종료 이벤트 처리
- [ ] 전체화면 기능 구현
- [ ] 비디오 썸네일 미리보기 추가

### 2.3 비디오 로딩 상태
- [ ] 비디오 로딩 중 스켈레톤 구현
- [ ] 비디오 로드 실패를 위한 오류 경계 추가
- [ ] 비디오를 사용할 수 없을 때 폴백 UI 생성
- [ ] YouTube API 제한 및 오류 처리

## 3단계: UI 구현

### 3.1 컴포넌트 레이아웃 및 스타일링
- [ ] 기존 컴포넌트와 일치하는 카드 기반 레이아웃 디자인
- [ ] 모바일 및 데스크톱용 반응형 디자인 구현
- [ ] 일관된 간격 및 타이포그래피 사용
- [ ] 호버 상태 및 트랜지션 추가
- [ ] 비디오를 위한 적절한 종횡비 보장

### 3.2 비디오 정보 표시
- [ ] finishline_video_info에서 비디오 제목/이름 표시
- [ ] 참가자별 타이밍 정보 표시
- [ ] 비디오 지속시간 및 진행률 표시기 추가
- [ ] 비디오 썸네일 및 메타데이터 포함

### 3.3 모바일 최적화
- [ ] 모바일 화면용 비디오 차원 최적화
- [ ] 터치 친화적 컨트롤 및 상호작용
- [ ] 모바일 비디오 재생 적절한 처리
- [ ] 대역폭을 고려한 로딩 전략

## 4단계: RunnerSpotlight와의 통합

### 4.1 컴포넌트 통합
- [ ] RunnerSpotlight.tsx에 FinishlineVideo import
- [ ] 비디오 컴포넌트를 위한 조건부 렌더링 로직 추가
- [ ] RunnerSpotlight에서 FinishlineVideo로 필요한 props 전달
- [ ] 기존 컴포넌트 순서 및 레이아웃 유지

### 4.2 Props 전달 및 데이터 흐름
- [ ] 이벤트 데이터가 적절히 전달되는지 확인
- [ ] timingDetail prop 처리 (null 경우)
- [ ] 시작 시간 계산을 위해 isAllPhotos 플래그 전달
- [ ] 데이터 타입 및 흐름 검증

### 4.3 레이아웃 통합
- [ ] 기존 그리드 레이아웃에 비디오 컴포넌트 통합
- [ ] 다른 컴포넌트와 반응형 동작 유지
- [ ] 적절한 간격 및 시각적 계층 구조 보장
- [ ] 다양한 화면 크기로 테스트

## 5단계: 오류 처리 및 엣지 케이스

### 5.1 데이터 검증
- [ ] finishline_video_info 구조 검증
- [ ] 누락되거나 유효하지 않은 비디오 URL 처리
- [ ] 유효한 YouTube 비디오 ID 확인
- [ ] 타이밍 데이터 타입 및 범위 검증

### 5.2 오류 시나리오
- [ ] YouTube 비디오를 사용할 수 없거나 비공개인 경우 처리
- [ ] 네트워크 연결 문제 처리
- [ ] 브라우저 호환성 문제 처리
- [ ] 모든 오류 상태에 대한 우아한 폴백

### 5.3 엣지 케이스
- [ ] isAllPhotos = true 처리 (특정 참가자 없음)
- [ ] 참가자를 위한 타이밍 데이터 누락 처리
- [ ] 유효하지 않은 시간 계산 처리
- [ ] firstParticipantGunTime이 0이거나 null인 경우 처리

## 6단계: 성능 및 최적화

### 6.1 로딩 성능
- [ ] 비디오 컴포넌트 지연 로딩 구현
- [ ] 초기 표시를 위해 YouTube 썸네일 사용
- [ ] 비디오 플레이어 초기화 최적화
- [ ] 페이지 로드 시간에 대한 영향 최소화

### 6.2 메모리 및 리소스 관리
- [ ] 비디오 플레이어 리소스의 적절한 정리
- [ ] 컴포넌트 언마운팅 처리
- [ ] 비디오 버퍼 및 메모리 사용량 관리
- [ ] 모바일 배터리 사용량 최적화

## 7단계: 테스트 및 검증

### 7.1 기능 테스트
- [ ] 유효한 YouTube URL로 비디오 재생 테스트
- [ ] 시작 시간 계산 정확성 테스트
- [ ] 다양한 참가자 타이밍 시나리오로 테스트
- [ ] 오류 처리 및 폴백 테스트

### 7.2 반응형 테스트
- [ ] 모바일 기기 테스트 (iOS/Android)
- [ ] 태블릿 및 데스크톱 테스트
- [ ] 다양한 화면 방향으로 테스트
- [ ] 다양한 네트워크 조건으로 테스트

### 7.3 크로스 브라우저 테스트
- [ ] Chrome, Safari, Firefox에서 비디오 재생 테스트
- [ ] 다양한 모바일 브라우저 테스트
- [ ] react-player 호환성 테스트
- [ ] TypeScript 타입 검증

### 7.4 통합 테스트
- [ ] 기존 RunnerSpotlight 흐름과 통합 테스트
- [ ] 부모 컴포넌트로부터의 데이터 흐름 테스트
- [ ] 실제 이벤트 데이터 및 타이밍 정보로 테스트
- [ ] 사용자 상호작용 패턴 테스트

## 8단계: 문서화 및 코드 품질

### 8.1 코드 문서화
- [ ] 모든 함수에 JSDoc 주석 추가
- [ ] 컴포넌트 props 및 사용법 문서화
- [ ] 복잡한 로직에 인라인 주석 추가
- [ ] 오류 처리 패턴 문서화

### 8.2 코드 품질
- [ ] 기존 TypeScript 패턴 따르기
- [ ] 일관된 코드 스타일 유지
- [ ] 적절한 오류 처리 보장
- [ ] React 최적의 방법 따르기

### 8.3 접근성
- [ ] 비디오 컨트롤을 위한 적절한 ARIA 레이블 추가
- [ ] 키보드 내비게이션 지원 보장
- [ ] 스크린 리더 호환성 추가
- [ ] 접근성 도구로 테스트

## 성공 기준 체크리스트

### 기능적 요구사항
- [ ] finishline_video_info가 있을 때 비디오 표시
- [ ] 참가자를 위한 올바른 시작 시간 계산
- [ ] 타이밍 데이터가 누락되었을 때 우아한 처리
- [ ] 유효하지 않거나 누락된 비디오에 대한 적절한 폴백
- [ ] 모든 화면 크기에서 반응형 디자인

### 기술적 요구사항
- [ ] TypeScript 오류 없음
- [ ] 콘솔 오류 또는 경고 없음
- [ ] 적절한 메모리 관리
- [ ] 빠른 로딩 성능
- [ ] 크로스 브라우저 호환성

### 사용자 경험 요구사항
- [ ] 부드러운 비디오 재생
- [ ] 직관적인 컨트롤
- [ ] 명확한 로딩 상태
- [ ] 도움이 되는 오류 메시지
- [ ] 기존 UI 패턴과 일관성

## 구현 우선순위

### 높은 우선순위 (필수)
1. react-player를 사용한 기본 비디오 컴포넌트
2. 시작 시간 계산 로직
3. RunnerSpotlight와의 통합
4. 기본 오류 처리
5. 반응형 디자인

### 중간 우선순위 (있으면 좋음)
1. 고급 오류 처리 및 엣지 케이스
2. 로딩 상태 및 스켈레톤
3. 성능 최적화
4. 모바일 최적화
5. 접근성 기능

### 낮은 우선순위 (추가 기능)
1. 고급 비디오 컨트롤
2. 분석 추적
3. 고급 스타일링 옵션
4. 추가 비디오 기능
5. 향상된 오류 복구

## 참고사항 및 고려사항

### 기술적 참고사항
- YouTube 비디오에는 임베딩 제한이 있을 수 있음
- react-player가 대부분의 크로스 브라우저 호환성을 처리함
- 고급 기능 구현 시 YouTube API 할당량 고려
- 비디오 시작 시간 정밀도는 YouTube API 제한으로 달라질 수 있음

### 디자인 참고사항
- 기존 카드 컴포넌트와 일관성 유지
- 기존 색상 구성 및 타이포그래피 사용
- 확립된 간격 및 레이아웃 패턴 따르기
- 사용자 컨텍스트 고려 (참가자가 자신의 피니시를 보는 상황)

### 성능 참고사항
- 비디오는 모바일에서 대역폭 집약적일 수 있음
- 비디오 품질 옵션 구현 고려
- 성능을 위해 지연 로딩이 필수적임
- Core Web Vitals에 대한 영향 모니터링